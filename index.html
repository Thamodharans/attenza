<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="manifest" href="./manifest.json">
    <link rel="stylesheet" href="styles.css">
    <!-- Menu-specific CSS (kept separate as you requested) -->
    <link rel="stylesheet" href="menu.css">
    <meta name="theme-color" content="#8b7cc8">
    <link rel="apple-touch-icon" href="./icons/icon-192.png">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Gaegu:wght@300;400;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Cedarville+Cursive&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Cabin+Sketch:wght@400;700&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">

    <style>
      /* Keep initial body hidden until auth completes (from original index.html) */
      body {
        visibility: hidden;
      }
    </style>

    <title>ATTENZA - for Dispur College</title>

    <script type="module">
      import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
      import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

      const firebaseConfig = {
        apiKey: "AIzaSyDbFEWKJylJJgNw0KIyFsDxlDKPwJII73o",
        authDomain: "attenza-app.firebaseapp.com",
        projectId: "attenza-app",
        storageBucket: "attenza-app.firebasestorage.app",
        messagingSenderId: "435010148378",
        appId: "1:435010148378:web:e5540806fd0ef90b16d9a3"
      };

      const app = initializeApp(firebaseConfig);
      const auth = getAuth(app);

      onAuthStateChanged(auth, (user) => {
        if (!user) {
          window.location.replace("login.html");
        } else {
          document.body.style.visibility = "visible";
        }
      });
    </script>

</head>

<body>
<div class="header" id="header">
    <div class="top-bar">
        <div class="left-section">
            <button class="icon-btn" aria-label="Menu">
                <div class="menu-mini"><span></span></div>
            </button>
            <div class="brand-container">
                <span class="brand-name">ATTENZA</span>
                <span class="tagline">a student driven attendance tracker</span>
            </div>
        </div>

        <button class="icon-btn notif-rev" aria-label="Notifications">
            <svg
                viewBox="0 0 24 24"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
                aria-hidden="true"
            >
                <path
                    d="M12 5.365V3m0 2.365a5.338 5.338 0 0 1 5.133 5.368v1.8c0 2.386 1.867 2.982 1.867 4.175 0 .593 0 1.292-.538 1.292H5.538C5 18 5 17.301 5 16.708c0-1.193 1.867-1.789 1.867-4.175v-1.8A5.338 5.338 0 0 1 12 5.365ZM8.733 18c.094.852.306 1.54.944 2.112a3.48 3.48 0 0 0 4.646 0c.638-.572 1.236-1.26 1.33-2.112h-6.92Z"
                    stroke-width="2.25"
                    stroke-linejoin="round"
                    stroke-linecap="round"
                    stroke="currentColor"
                ></path>
            </svg>
            <div class="notif-dot"></div>
        </button>
    </div>

    <div class="expand-section">
        <div class="expand-arrow" id="expandArrow">
            <svg viewBox="0 0 24 24" fill="none">
                <path d="M6 9l6 6 6-6" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
        </div>

        <div class="expanded-content" id="expandedContent">
            <div class="content-inner">
                <div class="info-section">
                    <h3>About ATTENZA</h3>
                    <p>A student-driven attendance tracker designed exclusively for Dispur College students. View your attendance data anytime, anywhere - something our teacher-driven system doesn't allow.</p>
                </div>

                <div class="info-section">
                    <h3>Key Features</h3>
                    <div class="features">
                        <div class="feature-card">
                            <h4>ðŸ“Š Real-time Data</h4>
                            <p>Check your attendance percentage instantly</p>
                        </div>
                        <div class="feature-card">
                            <h4>ðŸ“… Subject-wise View</h4>
                            <p>Track attendance for each subject separately</p>
                        </div>
                        <div class="feature-card">
                            <h4>ðŸ”” Smart Alerts</h4>
                            <p>Get notified when attendance falls below threshold</p>
                        </div>
                        <div class="feature-card">
                            <h4>ðŸ“± Mobile Friendly</h4>
                            <p>Access from any device, anytime</p>
                        </div>
                    </div>
                </div>

                <div class="info-section">
                    <h3>How to Use</h3>
                    <p>1. Log in with your college ID<br>
                        2. View your dashboard with attendance summary<br>
                        3. Click on any subject to see detailed records<br>
                        4. Set alerts for attendance warnings</p>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="sketch-line-container">
    <span class="sketch-line">
        I
        <svg class="sketch-heart" viewBox="0 0 120 120">
            <path d="M60 105
                     C20 70, 10 40, 30 25
                     C50 10, 70 20, 60 40
                     C80 10, 110 25, 90 50
                     C70 80, 60 95, 60 105 Z"/>
            <g stroke="#e63946"
               stroke-width="4"
               fill="none"
               stroke-linecap="round"
               stroke-linejoin="round"
               opacity="0.9">

                <path d="M35 60 Q 55 50 80 55" />
                <path d="M32 68 Q 55 60 85 64" />
                <path d="M34 76 Q 55 70 82 75" />
                <path d="M37 84 Q 58 78 79 82" />

                <path d="M45 45 Q 60 55 78 68" />
                <path d="M40 52 Q 55 64 75 78" />

                <path d="M50 70 Q 55 68 60 72" />
                <path d="M58 80 Q 63 78 68 82" />
            </g>
        </svg>
        Dispur College
    </span>
</div>

<div class="content-body">
    <div class="welcome-section">
        <div class="welcome-content">
            <div class="welcome-text-content">
                <h3 id="welcomeTitle">Hello, User!</h3>
                <p id="welcomeSubtitle">Great progress! Keep maintaining your attendance streak.</p>
                <div class="attendance-ring">
                    <svg class="ring-svg" viewBox="0 0 160 160">
                        <circle class="ring-bg-circle" cx="80" cy="80" r="70"></circle>
                        <circle class="ring-progress-circle" cx="80" cy="80" r="70" id="progressCircle"></circle>
                    </svg>
                    <div class="ring-center">
                        <span class="percentage" id="percentageText">75%</span>
                        <span class="percentage-label">Overall</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="notebook-section">
    <div class="page">
        <img src="Image/your-logo.png" alt="Logo" class="note-logo">
        <div class="margin"></div>

        <p>
            Keep a quick note of important classes, make-up days or attendance targets here.
            This space can work like your personal college notebook page.
        </p>

        <div class="teacher-mark">
            <span class="teacher-sign">Principal</span>
        </div>
    </div>
</div>

<div class="install-strip" id="installStrip">
    <div class="install-content">
        <span class="install-text" id="installText">Install this site as an app</span>
        <button class="close-strip" id="closeStrip">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="18" y1="6" x2="6" y2="18"></line>
                <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
        </button>
    </div>
</div>

<div class="section-header">
    <h3>Today's Schedule</h3>
    <a href="#" class="view-all">
        VIEW
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="9 18 15 12 9 6"></polyline>
        </svg>
    </a>
</div>

<div class="carousel-container">
    <div class="carousel" id="carousel">
        <div class="class-card">
            <div class="class-header">
                <span class="class-subject">Data Structures</span>
                <span class="class-time">09:00 AM</span>
            </div>
            <div class="class-details">
                <div><strong>Room:</strong> CS-301</div>
                <div><strong>Faculty:</strong> Dr. Smith</div>
                <div><strong>Duration:</strong> 1 hour</div>
            </div>
            <div class="attendance-actions">
                <button class="attendance-btn btn-attend">Attend</button>
                <button class="attendance-btn btn-skip">Skip</button>
                <button class="attendance-btn btn-not-held">Not Held</button>
            </div>
        </div>

        <div class="class-card">
            <div class="class-header">
                <span class="class-subject">Database Systems</span>
                <span class="class-time">11:00 AM</span>
            </div>
            <div class="class-details">
                <div><strong>Room:</strong> CS-205</div>
                <div><strong>Faculty:</strong> Prof. Johnson</div>
                <div><strong>Duration:</strong> 1.5 hours</div>
            </div>
            <div class="attendance-actions">
                <button class="attendance-btn btn-attend">Attend</button>
                <button class="attendance-btn btn-skip">Skip</button>
                <button class="attendance-btn btn-not-held">Not Held</button>
            </div>
        </div>

        <div class="class-card">
            <div class="class-header">
                <span class="class-subject">Web Development</span>
                <span class="class-time">02:00 PM</span>
            </div>
            <div class="class-details">
                <div><strong>Room:</strong> Lab-102</div>
                <div><strong>Faculty:</strong> Ms. Williams</div>
                <div><strong>Duration:</strong> 2 hours</div>
            </div>
            <div class="attendance-actions">
                <button class="attendance-btn btn-attend">Attend</button>
                <button class="attendance-btn btn-skip">Skip</button>
                <button class="attendance-btn btn-not-held">Not Held</button>
            </div>
        </div>

        <div class="class-card">
            <div class="class-header">
                <span class="class-subject">Computer Networks</span>
                <span class="class-time">04:00 PM</span>
            </div>
            <div class="class-details">
                <div><strong>Room:</strong> CS-102</div>
                <div><strong>Faculty:</strong> Dr. Anderson</div>
                <div><strong>Duration:</strong> 1 hour</div>
            </div>
            <div class="attendance-actions">
                <button class="attendance-btn btn-attend">Attend</button>
                <button class="attendance-btn btn-skip">Skip</button>
                <button class="attendance-btn btn-not-held">Not Held</button>
            </div>
        </div>
    </div>
</div>

<!-- Periodical & Date-wise sections (original content continues) -->
<section class="periodical-section">
    <header class="periodical-header">
        <h2>Periodical records</h2>
    </header>

    <div class="date-picker-container">
        <div class="custom-flatpickr">
            <input
                type="text"
                placeholder="Select date range..."
                data-input
                id="rangePicker"
            />
            <div class="date-display" id="dateDisplay">
                <span class="date-part empty" id="startDate">Select date</span>
                <span class="date-separator">to</span>
                <span class="date-part empty" id="endDate">Select date</span>
            </div>
            <span class="calendar-icon" aria-hidden="true">
                <svg viewBox="0 0 24 24" fill="none" stroke="#323544" stroke-width="2"
                     stroke-linecap="round" stroke-linejoin="round">
                    <rect x="3" y="4" width="18" height="18" rx="3" ry="3"></rect>
                    <line x1="3" y1="10" x2="21" y2="10"></line>
                    <line x1="8" y1="2" x2="8" y2="6"></line>
                    <line x1="16" y1="2" x2="16" y2="6"></line>
                </svg>
            </span>
        </div>
        <p class="date-picker-helper">for selected period</p>
    </div>

    <!-- bento-grid and cards omitted from cut for brevity (kept in your styles) -->
    <section class="bento-grid">
        <!-- metric cards and subject cards -->
        <!-- ... your original content remains here (unchanged) ... -->
    </section>
</section>

<!-- Date-wise records (kept as in original index.html) -->
<section class="periodical-section" id="dateWiseRecordsSection">
    <header class="app-header">
        <div class="title-block">
            <h1>Date-wise Records</h1>
            <span class="subtitle" id="selectedDateLabel">Loadingâ€¦</span>
        </div>

        <div class="month-year-select">
            <span class="edit-icon" aria-hidden="true">
                <svg clip-rule="evenodd" fill-rule="evenodd" stroke-linejoin="round" stroke-miterlimit="2" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path d="m19 20.25c0-.402-.356-.75-.75-.75-2.561 0-11.939 0-14.5 0-.394 0-.75.348-.75.75s.356.75.75.75h14.5c.394 0 .75-.348.75-.75zm-7.403-3.398 9.124-9.125c.171-.171.279-.423.279-.684 0-.229-.083-.466-.28-.662l-3.115-3.104c-.185-.185-.429-.277-.672-.277s-.486.092-.672.277l-9.143 9.103c-.569 1.763-1.555 4.823-1.626 5.081-.02.075-.029.15-.029.224 0 .461.349.848.765.848.511 0 .991-.189 5.369-1.681zm-3.27-3.342 2.137 2.137-3.168 1.046zm.955-1.166 7.651-7.616 2.335 2.327-7.637 7.638z" />
                </svg>
            </span>
            <select id="monthYearSelect" aria-label="Month and year"></select>
        </div>
    </header>

    <section class="date-strip-wrapper" aria-label="Date picker">
        <div class="date-strip" id="dateStrip"></div>
    </section>

    <section class="cards-container" id="dateCardsContainer" aria-label="Attendance records"></section>
</section>

<!-- Edit modal (from original) -->
<div class="modal-backdrop hidden" id="editModal">
    <div class="modal">
        <h3>Edit record</h3>
        <div class="modal-subject" id="modalSubject"></div>

        <div class="form-group">
            <label for="modalStatus">Status</label>
            <select id="modalStatus">
                <option value="present">Present</option>
                <option value="absent">Absent</option>
                <option value="not-held">Class not held</option>
            </select>
        </div>

        <div class="form-group">
            <label for="modalRemarks">Remarks / Notes</label>
            <textarea id="modalRemarks" placeholder="Add your notes for this class"></textarea>
        </div>

        <div class="modal-actions">
            <button class="btn btn-secondary" id="modalCancel">Cancel</button>
            <button class="btn btn-primary" id="modalSave">Save changes</button>
        </div>
    </div>
</div>

<!-- AI board and bottom AI card (from original) -->
<div class="ai-board-overlay">
    <div class="ai-board" id="aiBoard">
        <div class="ai-board-header">
            <h2 class="ai-title">Attenza AI</h2>
            <button class="ai-close-btn" id="aiCloseBtn" aria-label="Close AI">Ã—</button>
        </div>
        <div class="ai-board-body">
            <div class="ai-user-card-wrapper">
                <div class="ai-user-card" id="userMessageCard">
                    Your question will appear here.
                </div>
            </div>

            <div class="ai-status-row">
                <div class="ai-status-loader">
                    <div class="stripe"></div>
                    <div class="stripe"></div>
                    <div class="stripe"></div>
                    <div class="stripe"></div>
                </div>
                <span class="ai-status-text" id="aiStatusText">Analyzingâ€¦</span>
            </div>

            <div class="ai-response" id="aiResponse">

Here is a sample response from Attenza AI.

Once you connect Gemini and your attendance backend, this will show real, detailed insights.
</div>

<button class="ai-copy-btn" id="aiCopyBtn">
            <span>ðŸ“‹</span>
            <span>Copy</span>
        </button>
    </div>
</div>

<div class="ai-card-container">
  <div class="see-more-btn">

    <!-- AI Loader (WebP) -->
    <div class="logo-loader-wrapper">
      <img
        src="Image/Ailogo.webp"
        alt="Attenza AI"
        class="ai-loader-webp"
        loading="lazy"
        decoding="async"
      />
    </div>

    <span class="divider"></span>

    <!-- Prompt Area -->
    <div class="prompt-area" id="promptArea">
      <div class="prompt-display">
        <span class="typewriter-text" id="typewriterText"></span>
        <input
          type="text"
          id="promptInput"
          class="prompt-input"
          autocomplete="off"
          autocorrect="off"
          autocapitalize="sentences"
          spellcheck="false"
        />
      </div>

      <button class="send-btn" id="sendBtn">
        <svg viewBox="0 0 24 24" style="width:22px; height:22px;">
          <path d="M12 5L18 11" stroke="white" stroke-width="2.4" stroke-linecap="round"/>
          <path d="M12 5L6 11" stroke="white" stroke-width="2.4" stroke-linecap="round"/>
          <path d="M12 5V19" stroke="white" stroke-width="2.4" stroke-linecap="round"/>
        </svg>
      </button>
    </div>

  </div>
</div>

<!-- Menu HTML integrated (menu markup kept exactly as you provided) -->
<!-- This menu markup is placed as a sibling to the main content. -->
<div id="view-menu" class="app-view" aria-hidden="true" style="display:none;">
    <div class="container-top">
        <div class="header-row">
            <h1 class="header-title">Menu</h1>
            <button class="nav-btn" id="menuCloseBtn" aria-label="Close Menu">
                <span class="material-symbols-rounded">close</span>
            </button>
        </div>

        <div class="search-box" id="searchBoxContainer">
            <span class="material-symbols-rounded search-icon">search</span>
            <span class="search-prefix" id="searchPrefix">Roll â€“</span>

            <input type="tel" id="mainSearchInput" placeholder="Search any roll to check attendance" class="search-input" autocomplete="off">

            <div class="search-action-btn" id="actionBtn" onclick="activateSearchMode()">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round">
                    <line x1="5" y1="12" x2="19" y2="12"></line>
                    <polyline points="12 5 19 12 12 19"></polyline>
                </svg>
            </div>
        </div>
    </div>

    <div class="container-scroll" id="scrollContent">
        <div class="menu-profile-card">
            <img src="https://images.unsplash.com/photo-1535713875002-d1d0cf377fde?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=80" class="menu-profile-img" alt="Profile">
            <div class="menu-profile-info">
                <h2 class="menu-profile-name">Johnathan Doe</h2>
                <p class="menu-profile-email">john.doe23@university.edu</p>

                <div class="profile-pills">
                    <span class="pill pill-purple">Roll - 234</span>
                    <span class="pill pill-purple">B.Com 1st Sem</span>
                </div>

                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="edit-icon"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" /><path d="M13.5 6.5l4 4" /><path d="M16 21l5 -5" /><path d="M21 21v.01" /><path d="M16 16v.01" /></svg>
            </div>
        </div>

        <div class="menu-card" style="margin-bottom: 20px; padding-bottom: 15px;">
            <div class="menu-header">
                <span class="menu-header-text">Dispur College</span>
                <span class="material-symbols-rounded" style="color: #d1d5db; font-size: 18px;">school</span>
            </div>

            <div class="menu-item active" style="padding: 14px 16px;" onclick="window.location.href='setup.html'">
                <div class="status-dot"></div>
                <div class="menu-icon-box purple-bg">
                    <span class="material-symbols-rounded" style="font-size: 18px;">library_add</span>
                </div>
                <div class="menu-text">
                    <p class="menu-title">Select Subjects</p>
                    <p class="menu-subtitle">Set up subjects to track attendance</p>
                </div>
                <span class="material-symbols-rounded chevron-active">chevron_right</span>
            </div>
        </div>

        <div class="menu-card">
            <a href="#" class="menu-item">
                <span class="material-symbols-rounded menu-icon-gray">badge</span>
                <span class="menu-item-text">Important Staff</span>
                <span class="material-symbols-rounded chevron">chevron_right</span>
            </a>
            <div class="divider"></div>
            <a href="#" class="menu-item">
                <span class="material-symbols-rounded menu-icon-gray">group_add</span>
                <span class="menu-item-text">Refer a Friend</span>
                <span class="material-symbols-rounded chevron">chevron_right</span>
            </a>
            <div class="divider"></div>
            <a href="#" class="menu-item">
                <span class="material-symbols-rounded menu-icon-gray">chat_bubble</span>
                <span class="menu-item-text">Report Issue</span>
                <span class="material-symbols-rounded chevron">chevron_right</span>
            </a>
            <div class="divider"></div>
            <a href="#" class="menu-item">
                <span class="material-symbols-rounded menu-icon-gray">gpp_maybe</span>
                <span class="menu-item-text">Terms & Privacy</span>
                <span class="material-symbols-rounded chevron">chevron_right</span>
            </a>
        </div>

        <div class="logout-section">
            <button class="btn-logout" onclick="signOutFromMenu()">
                <span class="material-symbols-rounded">logout</span>
                Log Out
            </button>
            <div class="version-text">Attenza Educational â€¢ v1.0.4</div>
        </div>
    </div>
</div>

<!-- Result overlay for menu search (integrated) -->
<div id="result-overlay-container" style="display:none;">
    <div class="overlay-backdrop" onclick="exitSearchMode()"></div>

    <div class="result-wrapper">
        <div class="result-header">
            <span class="helper-text">Showing students from</span>

            <div class="dropdown-wrapper" id="classDropdown">
                <div class="class-pill" onclick="toggleDropdown()">
                    <span id="selectedClassText">B.Com Sem 5</span>
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg>
                </div>

                <div class="dropdown-list">
                    <div class="dropdown-item" onclick="selectClass('B.Com Sem 5')">B.Com Sem 5</div>
                    <div class="dropdown-item" onclick="selectClass('B.Com Sem 3')">B.Com Sem 3</div>
                    <div class="dropdown-item" onclick="selectClass('B.A. Sem 1')">B.A. Sem 1</div>
                    <div class="dropdown-item" onclick="selectClass('H.S. 2nd Year')">H.S. 2nd Year</div>
                </div>
            </div>
        </div>

        <div class="result-card" id="foundState">
            <div class="card-left">
                <div class="avatar-box">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg>
                </div>
                <div class="info-group">
                    <div class="student-name">Rahul Sharma</div>
                    <div class="data-freshness">
                        <span class="status-dot-result"></span>
                        Updated 2h ago
                    </div>
                </div>
            </div>
            <div class="card-right">
                <span class="percentage-val">78%</span>
                <span class="percentage-label">Overall</span>
            </div>
        </div>

        <div class="empty-card" id="emptyState">
            <div class="empty-icon">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="8" x2="12" y2="12"></line><line x1="12" y1="16" x2="12.01" y2="16"></line></svg>
            </div>
            <div class="empty-title">No student found</div>
            <div class="empty-desc">Your classmates in this section are not using Attendmark yet.</div>

            <button class="invite-pill">
                Invite Friend
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="18" cy="5" r="3"></circle>
                    <circle cx="6" cy="12" r="3"></circle>
                    <circle cx="18" cy="19" r="3"></circle>
                    <line x1="8.59" y1="13.51" x2="15.42" y2="17.49"></line>
                    <line x1="15.41" y1="6.51" x2="8.59" y2="10.49"></line>
                </svg>
            </button>
        </div>
    </div>
</div>

<!-- flatpickr (kept as external CDN) -->
<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
<!-- your JavaScript (kept in external file app.js as requested) -->
<script src="app.js"></script>

<!-- Small inline menu wiring so menu opens/closes and nothing leaks until you provide combined app.js.
     These are minimal helpers and do not modify any UI styles â€” once you ask for the combined app.js
     I will merge these into app.js and remove the inline script. -->
<script>
  (function () {
    // Query the menu button by aria-label (preserves original markup)
    const menuButton = document.querySelector('button[aria-label="Menu"]');
    const menuView = document.getElementById('view-menu');
    const menuCloseBtn = document.getElementById('menuCloseBtn');
    const resultOverlay = document.getElementById('result-overlay-container');

    // If menu elements exist, wire them up
    if (menuButton && menuView) {
      menuButton.addEventListener('click', () => {
        // show menu
        menuView.style.display = 'flex';
        menuView.setAttribute('aria-hidden', 'false');
        // make it scrollable & focus on the search input
        document.body.style.overflow = 'hidden'; // prevent background scrolling
        // small delay to allow layout
        setTimeout(() => {
          const si = document.getElementById('mainSearchInput');
          if (si) si.focus();
        }, 200);
      });
    }

    if (menuCloseBtn) {
      menuCloseBtn.addEventListener('click', () => {
        menuView.style.display = 'none';
        menuView.setAttribute('aria-hidden', 'true');
        document.body.style.overflow = ''; // restore
      });
    }

    // Sign-out helper used by menu logout button â€” calls firebase if available (safe fallback)
    window.signOutFromMenu = async function () {
      try {
        if (window.firebase && firebase.auth) {
          await firebase.auth().signOut();
        } else if (typeof signOut === 'function') {
          // if your app.js exposes a signOut function, call it
          signOut();
        } else {
          // fallback: redirect to login for now
          window.location.href = 'login.html';
        }
      } catch (e) {
        console.warn('Sign-out failed or firebase not available yet.', e);
        window.location.href = 'login.html';
      }
    };

    // Menu search behaviour and overlay actions (kept local until you request merging into app.js)
    const searchInput = document.getElementById('mainSearchInput');
    const searchBox = document.getElementById('searchBoxContainer');
    const actionBtn = document.getElementById('actionBtn');
    const scrollContent = document.getElementById('scrollContent');

    if (searchInput) {
      searchInput.addEventListener('focus', () => {
        searchBox.classList.add('active');
      });

      searchInput.addEventListener('blur', () => {
        if (searchInput.value.length === 0) {
          searchBox.classList.remove('active');
        }
      });

      searchInput.addEventListener('input', (e) => {
        const val = e.target.value.replace(/[^0-9]/g, '');
        e.target.value = val;
        if (val.length > 0) {
          actionBtn.classList.add('visible');
        } else {
          actionBtn.classList.remove('visible');
        }
      });
    }

    window.activateSearchMode = function () {
      if (scrollContent) scrollContent.classList.add('content-blurred');
      if (resultOverlay) resultOverlay.style.display = 'flex';
      if (searchInput) searchInput.blur();
    };

    window.exitSearchMode = function () {
      if (scrollContent) scrollContent.classList.remove('content-blurred');
      if (resultOverlay) resultOverlay.style.display = 'none';
      if (searchInput) searchInput.value = '';
      if (actionBtn) actionBtn.classList.remove('visible');
      if (searchBox) searchBox.classList.remove('active');
    };

    // Dropdown / result toggles
    window.toggleDropdown = function () {
      const el = document.getElementById('classDropdown');
      if (el) el.classList.toggle('active');
    };

    window.selectClass = function (className) {
      const sel = document.getElementById('selectedClassText');
      const foundState = document.getElementById('foundState');
      const emptyState = document.getElementById('emptyState');
      if (sel) sel.textContent = className;
      const dd = document.getElementById('classDropdown');
      if (dd) dd.classList.remove('active');

      if (className === 'B.Com Sem 5') {
        if (foundState) foundState.style.display = 'flex';
        if (emptyState) emptyState.style.display = 'none';
      } else {
        if (foundState) foundState.style.display = 'none';
        if (emptyState) emptyState.style.display = 'block';
      }
    };

    // click-away to close dropdown
    document.addEventListener('click', function (event) {
      const dropdown = document.getElementById('classDropdown');
      if (dropdown && !dropdown.contains(event.target) && !event.target.closest('.class-pill')) {
        dropdown.classList.remove('active');
      }
    });

    // Cleanup on page unload (restore body overflow)
    window.addEventListener('beforeunload', () => {
      document.body.style.overflow = '';
    });
  })();
</script>
</body>
</html>
